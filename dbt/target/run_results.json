{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.14", "generated_at": "2025-08-08T16:24:05.897818Z", "invocation_id": "7a29c926-6b9f-42fd-b58c-27b5c147c669", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-08T16:24:05.052496Z", "completed_at": "2025-08-08T16:24:05.157301Z"}, {"name": "execute", "started_at": "2025-08-08T16:24:05.245111Z", "completed_at": "2025-08-08T16:24:05.409829Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4300825595855713, "adapter_response": {}, "message": "Database Error in model calendario (models/gold/calendario.sql)\n  syntax error at or near \";\"\n  LINE 84: ORDER BY data ASC;\n                            ^\n  compiled Code at target/run/br_educacao/models/gold/calendario.sql", "failures": null, "unique_id": "model.br_educacao.calendario", "compiled": true, "compiled_code": "WITH LIMITES AS (\n  SELECT\n    MIN(CAST(datadisponibilizacao AS DATE)) AS data_min,\n    MAX(CAST(datadisponibilizacao AS DATE)) AS data_max\n  FROM \"censo\".\"public_bronze\".\"bolsas-de-cotas-concedidas\"\n),\n\nDATAS AS (\n  SELECT generate_series(data_min, data_max, interval '1 day')::DATE AS data\n  FROM LIMITES\n),\n\nNOME_MESES AS (\n  SELECT * FROM (VALUES\n    (1, 'Janeiro'), (2, 'Fevereiro'), (3, 'Mar\u00e7o'), (4, 'Abril'),\n    (5, 'Maio'), (6, 'Junho'), (7, 'Julho'), (8, 'Agosto'),\n    (9, 'Setembro'), (10, 'Outubro'), (11, 'Novembro'), (12, 'Dezembro')\n  ) AS t(numero_mes, nome_mes)\n),\n\nCALENDARIO AS (\n  SELECT\n    d.data,\n    EXTRACT(DAY FROM d.data) AS dia,\n    LPAD(EXTRACT(MONTH FROM d.data)::TEXT, 2, '0') AS numero_mes,\n    m.nome_mes,\n    EXTRACT(YEAR FROM d.data) AS ano,\n\n    CASE EXTRACT(DOW FROM d.data)\n      WHEN 0 THEN 'Domingo'\n      WHEN 1 THEN 'Segunda-feira'\n      WHEN 2 THEN 'Ter\u00e7a-feira'\n      WHEN 3 THEN 'Quarta-feira'\n      WHEN 4 THEN 'Quinta-feira'\n      WHEN 5 THEN 'Sexta-feira'\n      WHEN 6 THEN 'S\u00e1bado'\n    END AS nome_dia_semana,\n\n    EXTRACT(WEEK FROM d.data) AS semana_do_ano,\n\n    CASE \n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 1 AND 2 THEN 'Bim 1\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 3 AND 4 THEN 'Bim 2\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 5 AND 6 THEN 'Bim 3\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 7 AND 8 THEN 'Bim 4\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 9 AND 10 THEN 'Bim 5\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 11 AND 12 THEN 'Bim 6\u00ba'\n    END AS bimestre,\n\n    CASE \n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 1 AND 3 THEN 'Tri 1\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 4 AND 6 THEN 'Tri 2\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 7 AND 9 THEN 'Tri 3\u00ba'\n      ELSE 'Tri 4\u00ba'\n    END AS trimestre,\n\n    CASE \n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 1 AND 6 THEN 'Sem 1\u00ba'\n      ELSE 'Sem 2\u00ba'\n    END AS semestre,\n\n    TO_CHAR(d.data, 'YYYY-MM-DD') AS data_formatada,\n    TO_CHAR(d.data, 'YYYY-MM') AS ano_mes,\n    CONCAT(EXTRACT(YEAR FROM d.data), '-', LPAD(EXTRACT(MONTH FROM d.data)::TEXT, 2, '0')) AS chave_ano_mes\n\n  FROM DATAS AS d\n  LEFT JOIN  NOME_MESES AS m\n    ON EXTRACT(MONTH FROM d.data) = m.numero_mes\n)\n\nSELECT * FROM CALENDARIO\nWHERE 1 = 1\nORDER BY data ASC;", "relation_name": "\"censo\".\"public_gold\".\"calendario\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-08T16:24:05.034499Z", "completed_at": "2025-08-08T16:24:05.131597Z"}, {"name": "execute", "started_at": "2025-08-08T16:24:05.201652Z", "completed_at": "2025-08-08T16:24:05.395245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.43875575065612793, "adapter_response": {}, "message": "Database Error in model bolsas_concedidas (models/raw/bolsas_concedidas.sql)\n  syntax error at or near \"select\"\n  LINE 12: select *\n           ^\n  compiled Code at target/run/br_educacao/models/raw/bolsas_concedidas.sql", "failures": null, "unique_id": "model.br_educacao.bolsas_concedidas", "compiled": true, "compiled_code": "-- raw/tabela bolsas-de-cotas-concedidas.sql que esta na camada raw\n\nSELECT *\n\n\nselect *\nfrom \"censo\".\"public_bronze\".\"bolsas-de-cotas-concedidas\"  -- o seed", "relation_name": "\"censo\".\"public_bronze\".\"raw__bolsas_de_cotas_concedidas\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-08T16:24:05.046671Z", "completed_at": "2025-08-08T16:24:05.134226Z"}, {"name": "execute", "started_at": "2025-08-08T16:24:05.230007Z", "completed_at": "2025-08-08T16:24:05.402775Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.43948888778686523, "adapter_response": {}, "message": "Database Error in model bolsistas (models/gold/bolsistas.sql)\n  syntax error at or near \";\"\n  LINE 27: WHERE row_num = 1;\n                            ^\n  compiled Code at target/run/br_educacao/models/gold/bolsistas.sql", "failures": null, "unique_id": "model.br_educacao.bolsistas", "compiled": true, "compiled_code": "WITH BOLSISTAS AS (\n    SELECT \n        CAST(idbolsa AS TEXT) AS id_bolsa,\n        CAST(bolsista AS TEXT) AS bolsista,\n        ROW_NUMBER() OVER (PARTITION BY idbolsa ORDER BY bolsista) AS row_num\n    FROM \"censo\".\"public_bronze\".\"bolsas-de-cotas-concedidas\"\n    WHERE 1 = 1\n    AND bolsista IS NOT NULL\n    AND bolsista != ''\n    AND idbolsa IS NOT NULL\n)\nSELECT\n    id_bolsa,\n    bolsista\nFROM BOLSISTAS\nWHERE row_num = 1;", "relation_name": "\"censo\".\"public_gold\".\"bolsistas\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T16:24:05.059371Z", "completed_at": "2025-08-08T16:24:05.130918Z"}, {"name": "execute", "started_at": "2025-08-08T16:24:05.138607Z", "completed_at": "2025-08-08T16:24:05.664557Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6497182846069336, "adapter_response": {"_message": "SELECT 118701", "code": "SELECT", "rows_affected": 118701}, "message": "SELECT 118701", "failures": null, "unique_id": "model.br_educacao.fato_bolsas", "compiled": true, "compiled_code": "SELECT\n    CAST(_id AS TEXT) AS id,\n    CAST(ano AS INTEGER) AS ano,\n    CAST(idbolsa AS TEXT) AS id_bolsa,\n    CAST(valortotalprevisto AS FLOAT) AS valortotalprevisto,\n    CAST(datadisponibilizacao AS DATE) AS data_disponibilizacao\nFROM \"censo\".\"public_bronze\".\"bolsas-de-cotas-concedidas\"\nWHERE 1 = 1", "relation_name": "\"censo\".\"public_gold\".\"fato_bolsas\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-08T16:24:05.565303Z", "completed_at": "2025-08-08T16:24:05.615030Z"}, {"name": "execute", "started_at": "2025-08-08T16:24:05.647492Z", "completed_at": "2025-08-08T16:24:05.765382Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26646924018859863, "adapter_response": {}, "message": "Database Error in model silver-bolsas-de-cotas-concedidas (models/silver/silver-bolsas-de-cotas-concedidas.sql)\n  column \"instituicaoexecutor_sigla\" does not exist\n  LINE 15:     CAST(instituicaoexecutor_sigla AS TEXT) AS instituicaoex...\n                    ^\n  compiled Code at target/run/br_educacao/models/silver/silver-bolsas-de-cotas-concedidas.sql", "failures": null, "unique_id": "model.br_educacao.silver-bolsas-de-cotas-concedidas", "compiled": true, "compiled_code": "SELECT\n    CAST(_id AS TEXT) AS id,\n    CAST(ano AS INTEGER) AS ano,\n    CAST(instituicaoexecutor_sigla AS TEXT) AS instituicaoexecutor_sigla,\n    CAST(instituicaoexecutor_nome AS TEXT) AS instituicaoexecutor_sigla,\n    CAST(programa AS TEXT) AS programa,\n    CAST(idbolsa AS TEXT) AS id_bolsa,\n    CAST(bolsista AS TEXT) AS bolsista,\n    CAST(valortotalprevisto AS FLOAT) AS valortotalprevisto,\n    CAST(datadisponibilizacao AS DATE) AS data_disponibilizacao\nFROM \"censo\".\"public_bronze\".\"bolsas-de-cotas-concedidas\"\nWHERE 1 = 1", "relation_name": "\"censo\".\"public_silver\".\"silver-bolsas-de-cotas-concedidas\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-08T16:24:05.557543Z", "completed_at": "2025-08-08T16:24:05.613818Z"}, {"name": "execute", "started_at": "2025-08-08T16:24:05.638644Z", "completed_at": "2025-08-08T16:24:05.768921Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2787933349609375, "adapter_response": {}, "message": "Database Error in model instituicoes (models/gold/instituicoes.sql)\n  syntax error at or near \";\"\n  LINE 27: WHERE row_num = 1;\n                            ^\n  compiled Code at target/run/br_educacao/models/gold/instituicoes.sql", "failures": null, "unique_id": "model.br_educacao.instituicoes", "compiled": true, "compiled_code": "WITH INSTITUICAO AS (\n    SELECT\n        CAST(_id AS TEXT) AS id,\n        INITCAP(CAST(instituicaoexecutor_sigla AS TEXT)) AS sigla_instituicao,\n        INITCAP(CAST(instituicaoexecutor_nome AS TEXT)) AS nome_instituicao,\n        INITCAP(CAST(programa AS TEXT)) AS programa,\n        ROW_NUMBER() OVER (\n            PARTITION BY _id\n            ORDER BY COALESCE(instituicaoexecutor_sigla, instituicaoexecutor_nome, programa) DESC\n        ) AS row_num\n    FROM \"censo\".\"public_bronze\".\"bolsas-de-cotas-concedidas\"\n    WHERE 1 = 1\n)\nSELECT *\nFROM INSTITUICAO\nWHERE row_num = 1;", "relation_name": "\"censo\".\"public_gold\".\"instituicoes\""}], "elapsed_time": 1.2933170795440674, "args": {"log_level_file": "debug", "macro_debugging": false, "partial_parse": true, "printer_width": 80, "static_parser": true, "log_level": "info", "enable_legacy_logger": false, "invocation_command": "dbt run --project-dir dbt --profiles-dir /opt/app/dbt/profiles --profile inep_postgres", "print": true, "version_check": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "defer": false, "exclude": [], "profiles_dir": "/opt/app/dbt/profiles", "log_format_file": "debug", "indirect_selection": "eager", "write_json": true, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "use_colors": true, "favor_state": false, "log_format": "default", "quiet": false, "select": [], "show_resource_report": false, "project_dir": "dbt", "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "log_path": "dbt/logs", "which": "run", "require_explicit_package_overrides_for_builtin_materializations": false, "profile": "inep_postgres", "introspect": true, "strict_mode": false, "use_colors_file": true}}