{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.14", "generated_at": "2025-08-08T21:22:47.634526Z", "invocation_id": "a3b785b4-1ff5-4869-b417-fd72f3be7e6b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T21:22:44.344128Z", "completed_at": "2025-08-08T21:22:44.395131Z"}, {"name": "execute", "started_at": "2025-08-08T21:22:44.402213Z", "completed_at": "2025-08-08T21:22:44.650837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32306337356567383, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.br_educacao.raw_bolsas_concedidas", "compiled": true, "compiled_code": "-- raw/tabela bolsas-de-cotas-concedidas.sql que esta na camada raw\n\n\n\nSELECT *\nFROM \"censo\".\"bronze\".\"bolsas-de-cotas-concedidas\"  -- o seed", "relation_name": "\"censo\".\"bronze\".\"raw_bolsas_concedidas\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T21:22:44.680544Z", "completed_at": "2025-08-08T21:22:44.714435Z"}, {"name": "execute", "started_at": "2025-08-08T21:22:44.723426Z", "completed_at": "2025-08-08T21:22:45.094582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42894864082336426, "adapter_response": {"_message": "SELECT 118701", "code": "SELECT", "rows_affected": 118701}, "message": "SELECT 118701", "failures": null, "unique_id": "model.br_educacao.silver_bolsas_concedidas", "compiled": true, "compiled_code": "\n\nSELECT\n    CAST(_id AS TEXT)                               as id,\n    CAST(ano AS INTEGER)                           as ano,\n    CAST(instituicaoexecutora_sigla AS TEXT)        as instituicaoexecutora_sigla,\n    CAST(instituicaoexecutora_nome  AS TEXT)        as instituicaoexecutora_nome,\n    CAST(programa AS TEXT)                         as programa,\n    CAST(idbolsa AS TEXT)                          as id_bolsa,\n    CAST(bolsista AS TEXT)                         as bolsista,\n    CAST(valortotalprevisto AS double precision) as valortotalprevisto,\n    CAST(datadisponibilizacao AS DATE) data_disponibilizacao\nFROM \"censo\".\"bronze\".\"raw_bolsas_concedidas\" \nWHERE 1 = 1", "relation_name": "\"censo\".\"silver\".\"silver_bolsas_concedidas\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T21:22:45.134133Z", "completed_at": "2025-08-08T21:22:45.179699Z"}, {"name": "execute", "started_at": "2025-08-08T21:22:45.188079Z", "completed_at": "2025-08-08T21:22:45.836139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.721912145614624, "adapter_response": {"_message": "SELECT 9724", "code": "SELECT", "rows_affected": 9724}, "message": "SELECT 9724", "failures": null, "unique_id": "model.br_educacao.gold_bolsistas", "compiled": true, "compiled_code": "\n\nWITH BOLSISTA as (\n    SELECT\n        id_bolsa,\n        bolsista\n    FROM (\n        SELECT\n            CAST(id_bolsa as text) as id_bolsa,\n            CAST(bolsista as text) as bolsista,\n            ROW_NUMBER() OVER (\n               PARTITION BY id_bolsa\n            ORDER BY bolsista\n            ) AS rn\n        FROM \"censo\".\"silver\".\"silver_bolsas_concedidas\"\n        WHERE bolsista IS NOT NULL\n          AND bolsista != ''\n          AND id_bolsa IS NOT NULL\n    ) t\n    WHERE rn = 1\n)\nSELECT\n    id_bolsa,\n    bolsista\nFROM BOLSISTA", "relation_name": "\"censo\".\"gold\".\"gold_bolsistas\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T21:22:45.888997Z", "completed_at": "2025-08-08T21:22:45.927268Z"}, {"name": "execute", "started_at": "2025-08-08T21:22:45.933465Z", "completed_at": "2025-08-08T21:22:46.142678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.27315807342529297, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.br_educacao.gold_calendario", "compiled": true, "compiled_code": "\nWITH LIMITES AS (\n  SELECT\n    MIN(CAST(data_disponibilizacao AS DATE)) AS data_min,\n    MAX(CAST(data_disponibilizacao AS DATE)) AS data_max\nFROM \"censo\".\"silver\".\"silver_bolsas_concedidas\"\n),\n\nDATAS AS (\n  SELECT generate_series(data_min, data_max, interval '1 day')::DATE AS data\n  FROM LIMITES\n),\n\nNOME_MESES AS (\n  SELECT * FROM (VALUES\n    (1, 'Janeiro'), (2, 'Fevereiro'), (3, 'Mar\u00e7o'), (4, 'Abril'),\n    (5, 'Maio'), (6, 'Junho'), (7, 'Julho'), (8, 'Agosto'),\n    (9, 'Setembro'), (10, 'Outubro'), (11, 'Novembro'), (12, 'Dezembro')\n  ) AS t(numero_mes, nome_mes)\n),\n\nCALENDARIO AS (\n  SELECT\n    d.data,\n    EXTRACT(DAY FROM d.data) AS dia,\n    LPAD(EXTRACT(MONTH FROM d.data)::TEXT, 2, '0') AS numero_mes,\n    m.nome_mes,\n    EXTRACT(YEAR FROM d.data) AS ano,\n\n    CASE EXTRACT(DOW FROM d.data)\n      WHEN 0 THEN 'Domingo'\n      WHEN 1 THEN 'Segunda-feira'\n      WHEN 2 THEN 'Ter\u00e7a-feira'\n      WHEN 3 THEN 'Quarta-feira'\n      WHEN 4 THEN 'Quinta-feira'\n      WHEN 5 THEN 'Sexta-feira'\n      WHEN 6 THEN 'S\u00e1bado'\n    END AS nome_dia_semana,\n\n    EXTRACT(WEEK FROM d.data) AS semana_do_ano,\n\n    CASE \n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 1 AND 2 THEN 'Bim 1\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 3 AND 4 THEN 'Bim 2\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 5 AND 6 THEN 'Bim 3\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 7 AND 8 THEN 'Bim 4\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 9 AND 10 THEN 'Bim 5\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 11 AND 12 THEN 'Bim 6\u00ba'\n    END AS bimestre,\n\n    CASE \n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 1 AND 3 THEN 'Tri 1\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 4 AND 6 THEN 'Tri 2\u00ba'\n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 7 AND 9 THEN 'Tri 3\u00ba'\n      ELSE 'Tri 4\u00ba'\n    END AS trimestre,\n\n    CASE \n      WHEN EXTRACT(MONTH FROM d.data) BETWEEN 1 AND 6 THEN 'Sem 1\u00ba'\n      ELSE 'Sem 2\u00ba'\n    END AS semestre,\n\n    TO_CHAR(d.data, 'YYYY-MM-DD') AS data_formatada,\n    TO_CHAR(d.data, 'YYYY-MM') AS ano_mes,\n    CONCAT(EXTRACT(YEAR FROM d.data), '-', LPAD(EXTRACT(MONTH FROM d.data)::TEXT, 2, '0')) AS chave_ano_mes\n\n  FROM DATAS AS d\n  LEFT JOIN  NOME_MESES AS m\n    ON EXTRACT(MONTH FROM d.data) = m.numero_mes\n)\n\nSELECT * FROM CALENDARIO\nWHERE 1 = 1", "relation_name": "\"censo\".\"gold\".\"gold_calendario\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T21:22:46.180406Z", "completed_at": "2025-08-08T21:22:46.223674Z"}, {"name": "execute", "started_at": "2025-08-08T21:22:46.233150Z", "completed_at": "2025-08-08T21:22:46.492696Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3293311595916748, "adapter_response": {"_message": "SELECT 118701", "code": "SELECT", "rows_affected": 118701}, "message": "SELECT 118701", "failures": null, "unique_id": "model.br_educacao.gold_fato_bolsa", "compiled": true, "compiled_code": "\n\nSELECT\n    id,\n    ano,\n    id_bolsa,\n    valortotalprevisto,\n    data_disponibilizacao\nFROM \"censo\".\"silver\".\"silver_bolsas_concedidas\"\nWHERE 1 = 1", "relation_name": "\"censo\".\"gold\".\"gold_fato_bolsa\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-08T21:22:46.529652Z", "completed_at": "2025-08-08T21:22:46.579099Z"}, {"name": "execute", "started_at": "2025-08-08T21:22:46.588082Z", "completed_at": "2025-08-08T21:22:47.544052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0315442085266113, "adapter_response": {"_message": "SELECT 118701", "code": "SELECT", "rows_affected": 118701}, "message": "SELECT 118701", "failures": null, "unique_id": "model.br_educacao.gold_instituicoes", "compiled": true, "compiled_code": "\n\n\n\nWITH INSTITUICAO AS (\n    SELECT\n        id,\n        INITCAP(CAST(instituicaoexecutora_sigla AS text)) AS sigla_instituicao,\n        INITCAP(CAST(instituicaoexecutora_nome   AS text)) AS nome_instituicao,\n        INITCAP(CAST(programa                  AS text)) AS programa\n    from \"censo\".\"silver\".\"silver_bolsas_concedidas\"\n),\nDEDUP AS (\n    SELECT\n        id,\n        sigla_instituicao,\n        nome_instituicao,\n        programa,\n        ROW_NUMBER() OVER (\n            PARTITION BY id\n            ORDER BY coalesce(sigla_instituicao, nome_instituicao, programa) DESC\n        ) AS rn\n    FROM INSTITUICAO\n    WHERE id is not null\n)\nSELECT\n    id,\n    sigla_instituicao,\n    nome_instituicao,\n    programa\nFROM DEDUP\nWHERE rn = 1", "relation_name": "\"censo\".\"gold\".\"gold_instituicoes\""}], "elapsed_time": 3.71716570854187, "args": {"log_format": "default", "log_file_max_bytes": 10485760, "use_colors": true, "log_level": "info", "use_colors_file": true, "exclude": [], "log_path": "dbt/logs", "invocation_command": "dbt run --project-dir dbt --profiles-dir /opt/app/dbt/profiles --profile inep_postgres", "enable_legacy_logger": false, "show_resource_report": false, "static_parser": true, "favor_state": false, "send_anonymous_usage_stats": true, "profiles_dir": "/opt/app/dbt/profiles", "introspect": true, "vars": {}, "partial_parse": true, "which": "run", "require_explicit_package_overrides_for_builtin_materializations": false, "print": true, "write_json": true, "log_format_file": "debug", "printer_width": 80, "cache_selected_only": false, "quiet": false, "select": [], "project_dir": "dbt", "defer": false, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "partial_parse_file_diff": true, "macro_debugging": false, "version_check": true, "log_level_file": "debug", "profile": "inep_postgres", "populate_cache": true, "strict_mode": false}}